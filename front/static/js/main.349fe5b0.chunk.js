(this["webpackJsonpr-backoffice"]=this["webpackJsonpr-backoffice"]||[]).push([[0],{236:function(e,t,a){},378:function(e,t,a){},453:function(e,t,a){},454:function(e,t,a){},455:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a(28),l=a.n(c),r=a(88),s=a(25),i=a(18),o=a(460),j=a(457),u=a(458),b=a(110),d=a(466),O=(a(236),a(5)),h={"/":"home","/upload":"upload"};function m(e){var t=e.onClick,a=Object(s.f)(),c=h[a.path],l=Object(n.useState)("home"===c),o=Object(i.a)(l,2),j=o[0],u=(o[1],Object(n.useState)(c)),m=Object(i.a)(u,2),f=m[0];m[1];return Object(O.jsxs)(O.Fragment,{children:[j&&Object(O.jsx)("div",{className:"HeaderMenu-ButtonGroup",children:Object(O.jsx)(b.a,{type:"primary",shape:"round",onClick:t,children:"Nueva Regla"})}),Object(O.jsxs)(d.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:[f],children:[Object(O.jsx)(d.a.Item,{children:Object(O.jsx)(r.b,{to:"/",children:"Reglas"})},"home"),Object(O.jsx)(d.a.Item,{children:Object(O.jsx)(r.b,{to:"/upload",children:"Validador"})},"upload")]})]})}var f=a(463),x=a(464),p=a(95),v=a(221),g=a(109),y=a(462),S=a(467),F=a(465),C=a(459),I=a(91),k=a(469),B=a(470),N=a(176),R=a(177),E=a.n(R);a(378);Object(N.addStyles)();var z=g.a.Option;function w(e){var t=e.data,a=e.disabled,c=y.a.useForm(),l=Object(i.a)(c,1)[0],r=Object(n.useState)(t?t.name:""),s=Object(i.a)(r,2),o=s[0],j=s[1],u=[{name:"name",value:o}];return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(y.a,{className:"RulesForm-PropertyForm",form:l,onValuesChange:function(e){var t=e.name;j(t)},fields:u,children:Object(O.jsx)(y.a.Item,{label:"Nombre",name:"name",children:Object(O.jsx)(S.a,{disabled:a,placeholder:"Ej: Estructura y denominaci\xf3n",value:o})})}),Object(O.jsx)(A,{value:t?t.formula:"",disabled:a})]})}function A(e){var t=e.value,a=e.disabled,c=y.a.useForm(),l=Object(i.a)(c,1)[0],r=Object(n.useState)(t||""),s=Object(i.a)(r,2),o=s[0],d=s[1],h=Object(n.useState)(""),m=Object(i.a)(h,2),f=m[0],x=m[1];Object(n.useEffect)((function(){return p()}),[]);var p=function(){return x(function(e){var t=" "+e,a=[{from:/^(\s|\()/,toLeft:"\\left",toRight:"\\right"},{from:/^count/,toLeft:"|",toRight:"|"},{from:/^sum/,toLeft:"\\sum{\\left",toRight:"\\right}"}];t=t.replace(/p(\d+)/g,"P_{$1}");for(var n=0,c=[{from:/and/g,to:"\\wedge"},{from:/or/g,to:"\\vee"},{from:/then/g,to:"\\rightarrow"},{from:/union|\|/g,to:"\\union"},{from:/inter|\&/g,to:"\\intersect"},{from:/empty/g,to:"\\varnothing"},{from:/!=/g,to:"\\neq"},{from:/>=/g,to:"\\geq"},{from:/<=/g,to:"\\leq"}];n<c.length;n++){var l=c[n],r=l.from,s=l.to;t=t.replace(r,s)}function o(e,t,a,n){return e.substring(0,t)+n+e.substring(a)}return(t=(t=(t=function e(t){for(var n=E.a.matchRecursive(t,"(\\w+|\\s)\\(","\\)","g",{valueNames:[null,"left","arg","right"]}),c="",l="",r=0;n.length>0;){var s,j=Object(v.a)(n);try{for(j.s();!(s=j.n()).done;){var u=s.value,b=u.name,d=u.value,O=u.start,h=u.end;if("left"==b){for(var m=0,f=a;m<f.length;m++){var x=f[m],p=x.from,g=x.toLeft,y=x.toRight;if(p.test(d)){c=g,l=y;break}}t=o(t,O+r,h+r,c),r+=c.length-d.length}else if("arg"==b){var S=e(d),F=Object(i.a)(S,2),C=F[0],I=F[1];t=o(t,O+r,h+r,C),r+=I}else t=o(t,O+r,h+r,l),r+=l.length-d.length}}catch(k){j.e(k)}finally{j.f()}n=E.a.matchRecursive(t,"\\w+\\(","\\)","g",{valueNames:[null,"left","arg","right"]})}return[t,r]}(t)[0]).replace(/\\left/g,"(")).replace(/\\right/g,")")).substr(1)}(o))},g=[{name:"formula",value:o}];return Object(O.jsxs)("div",{children:[Object(O.jsx)(y.a,{className:"RulesForm-PropertyForm",form:l,onValuesChange:function(e){var t=e.formula;return d(t)},fields:g,children:Object(O.jsxs)(j.a,{gutter:16,children:[Object(O.jsx)(u.a,{flex:"auto",children:Object(O.jsx)(y.a.Item,{label:"F\xf3rmula",name:"formula",children:Object(O.jsx)(S.a,{disabled:a,placeholder:"Ej: p0 and p1",value:o})})}),Object(O.jsx)(u.a,{children:Object(O.jsx)(b.a,{disabled:a,onClick:p,children:"Actualizar"})})]})}),Object(O.jsx)("div",{style:{display:f?"flex":"none",justifyContent:"center"},children:Object(O.jsx)(N.StaticMathField,{style:{fontSize:30},children:f})})]})}function D(e){var t=e.data,a=e.showActions,c=e.onDelete,l=e.shifted,r=e.disabled,s=y.a.useForm(),o=Object(i.a)(s,1)[0],j=Object(n.useState)(t?t.type:""),u=Object(i.a)(j,2),d=u[0],h=u[1],m=Object(n.useState)(t&&t.pset||""),f=Object(i.a)(m,2),x=f[0],p=f[1],v=Object(n.useState)(t?t.on:""),g=Object(i.a)(v,2),C=g[0],k=g[1],B=Object(n.useState)(t&&t.attribute||""),N=Object(i.a)(B,2),R=N[0],E=N[1],z=Object(n.useState)(t?t.operation:""),w=Object(i.a)(z,2),A=w[0],D=w[1],L=Object(n.useState)(t?t.value:""),T=Object(i.a)(L,2),G=T[0],P=T[1],V=[{name:"on",value:C},{name:"type",value:d},{name:"pset",value:x},{name:"attribute",value:R},{name:"operation",value:A},{name:"value",value:G}];return Object(O.jsxs)("div",{className:"RulesForm-FormDeleteable",children:[(a||l)&&Object(O.jsx)("div",{className:"RulesForm-FormDeleteabe-Actions",children:Object(O.jsx)(b.a,{danger:!0,shape:"circle",icon:Object(O.jsx)(I.a,{}),size:"Large",style:{opacity:l&&0},onClick:!l&&c})}),Object(O.jsxs)(y.a,{className:"RulesForm-PropertyForm",form:o,onValuesChange:function(e){var t=e.type,a=e.pset,n=e.on,c=e.attribute,l=e.operation,r=e.value;t&&h(t),a&&p(a),n&&k(n),c&&E(c),l&&D(l),r&&P(r)},fields:V,children:[Object(O.jsx)(y.a.Item,{label:"Sobre",name:"on",children:Object(O.jsxs)(F.a.Group,{value:C,children:[Object(O.jsx)(F.a.Button,{disabled:r,value:"entity",children:"Entidad"}),Object(O.jsx)(F.a.Button,{disabled:r,value:"type",children:"Tipo"})]})}),Object(O.jsx)(y.a.Item,{label:"Tipo",name:"type",children:Object(O.jsxs)(F.a.Group,{value:d,children:[Object(O.jsx)(F.a.Button,{disabled:r,value:"pset",children:"PropertySet"}),Object(O.jsx)(F.a.Button,{disabled:r,value:"attribute",children:"Atributo"}),Object(O.jsx)(F.a.Button,{disabled:r,value:"location",children:"Ubicaci\xf3n"})]})}),"pset"===d?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(y.a.Item,{label:"Nombre del Pset",name:"pset",children:Object(O.jsx)(S.a,{disabled:r,placeholder:"Ej: Pset_\\w+Common",value:x})}),Object(O.jsx)(y.a.Item,{label:"Nombre de la propiedad",name:"attribute",children:Object(O.jsx)(S.a,{disabled:r,placeholder:"Ej: IsExternal",value:R})})]}):"attribute"===d?Object(O.jsx)(y.a.Item,{label:"Nombre de la atributo",name:"attribute",children:Object(O.jsx)(S.a,{disabled:r,placeholder:"Ej: GlobalId",value:R})}):"location"===d?Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(y.a.Item,{label:"Coordenada",name:"attribute",children:Object(O.jsxs)(F.a.Group,{value:R,children:[Object(O.jsx)(F.a.Button,{disabled:r,value:"x",children:"X"}),Object(O.jsx)(F.a.Button,{disabled:r,value:"y",children:"Y"}),Object(O.jsx)(F.a.Button,{disabled:r,value:"z",children:"Z"})]})})}):null,Object(O.jsx)(y.a.Item,{label:"Operaci\xf3n",name:"operation",children:Object(O.jsxs)(F.a.Group,{value:A,children:[Object(O.jsx)(F.a.Button,{disabled:r,value:"eq",children:"="}),Object(O.jsx)(F.a.Button,{disabled:r,value:"neq",children:"\u2260"}),Object(O.jsx)(F.a.Button,{disabled:r,value:"g",children:">"}),Object(O.jsx)(F.a.Button,{disabled:r,value:"l",children:"<"}),Object(O.jsx)(F.a.Button,{disabled:r,value:"geq",children:"\u2265"}),Object(O.jsx)(F.a.Button,{disabled:r,value:"leq",children:"\u2264"}),Object(O.jsx)(F.a.Button,{disabled:r,value:"e",children:"\u2203"}),Object(O.jsx)(F.a.Button,{disabled:r,value:"ne",children:"\u2204"})]})}),"e"!==A&&"ne"!==A&&Object(O.jsx)(y.a.Item,{label:"Valor esperado",name:"value",children:Object(O.jsx)(S.a,{disabled:r,placeholder:"Ej: True",value:G})})]})]})}function L(e){var t=e.data,a=e.showActions,c=e.onDelete,l=e.disabled,r=y.a.useForm(),s=Object(i.a)(r,1)[0],o=Object(n.useState)(!1),j=Object(i.a)(o,2),u=j[0],d=j[1],h=Object(n.useRef)(),m=Object(n.useState)(t?t.action:"include"),f=Object(i.a)(m,2),x=f[0],v=f[1],g=Object(n.useState)(t?t.scope:""),B=Object(i.a)(g,2),N=B[0],R=B[1],E=Object(n.useState)(t&&t.space||""),z=Object(i.a)(E,2),w=z[0],A=z[1],L=Object(n.useState)(t?t.entities:[]),T=Object(i.a)(L,2),G=T[0],P=T[1],V=Object(n.useState)(t?t.constraints.map((function(e){return function(t,a,n,c){return Object(O.jsx)(D,{data:e,showActions:t,onDelete:a,shifted:n,disabled:c})}})):[function(e,t,a,n){return Object(O.jsx)(D,{showActions:e,onDelete:t,shifted:a,disabled:n})}]),H=Object(i.a)(V,2),q=H[0],J=H[1],M=[{name:"action",value:x},{name:"scope",value:N},{name:"space",value:w},{name:"entities",value:G.join(",")}];h.current=q;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"RulesForm-FormDeleteable",children:[a&&Object(O.jsx)("div",{className:"RulesForm-FormDeleteabe-Actions",children:Object(O.jsx)(b.a,{danger:!0,shape:"circle",icon:Object(O.jsx)(I.a,{}),size:"Large",onClick:c})}),Object(O.jsxs)(y.a,{form:s,onValuesChange:function(e){var t=e.action,a=e.scope,n=e.space,c=e.entities;a&&R(a),t&&v(t),c&&P(c.split(",")),n&&A(n)},fields:M,children:[Object(O.jsx)(y.a.Item,{label:"Buscar en",name:"scope",children:Object(O.jsxs)(F.a.Group,{value:N,children:[Object(O.jsx)(F.a.Button,{disabled:l,value:"global",children:"Todo el modelo"}),Object(O.jsx)(F.a.Button,{disabled:l,value:"space",children:"IfcSpace"})]})}),"space"===N&&Object(O.jsx)(y.a.Item,{label:"Nombre del espacio",name:"space",children:Object(O.jsx)(S.a,{disabled:l,placeholder:"Ej: Dormitorio Principal",value:w})}),Object(O.jsx)(y.a.Item,{label:"Entidades IFC",name:"entities",children:Object(O.jsx)(S.a,{disabled:l,placeholder:"Ej: IfcBuildingElement, IfcFurnishingElement",value:G.join()})})]})]}),q.map((function(e,t){return!!e&&Object(O.jsxs)(n.Fragment,{children:[Object(O.jsx)(C.a,{dashed:!0}),e(u&&q.filter((function(e){return!!e})).length>1,(function(){return delete q[t],void J(Object(p.a)(q))}),a||u&&1===q.filter((function(e){return!!e})).length,l)]},t)})),Object(O.jsxs)("div",{style:{marginTop:24},className:"RulesForm-ActionsContainer",children:[Object(O.jsx)("div",{}),Object(O.jsxs)("div",{className:"RulesForm-HorizontalItems",children:[(q.filter((function(e){return!!e})).length>1||u)&&Object(O.jsx)(b.a,{danger:!u,type:"dashed",onClick:function(){d(!u)},disabled:l,children:u?"Listo":"Quitar restricci\xf3n"}),Object(O.jsx)(b.a,{type:"dashed",disabled:u||l,onClick:function(){return J([].concat(Object(p.a)(q),[function(e,t,a,n){return Object(O.jsx)(D,{showActions:e,onDelete:t,shifted:a,disabled:n})}]))},icon:Object(O.jsx)(k.a,{}),children:"Agregar otra restricci\xf3n"})]})]})]})}function T(e){var t=e.actions,a=e.data,c=e.onClick,l=Object(n.useState)(a?a.filters.map((function(e,t){return function(a,n,c){return Object(O.jsx)(L,{showActions:a,onDelete:n,data:e,disabled:c},t)}})):[]),r=Object(i.a)(l,2),s=r[0],o=r[1],j=Object(n.useState)(-1),u=Object(i.a)(j,2),d=u[0],h=u[1],m=Object(n.useState)(!1),f=Object(i.a)(m,2),x=f[0],v=f[1],y=Object(n.useState)(!!a),S=Object(i.a)(y,2),F=S[0],I=S[1],k=Object(n.useState)(!1),N=Object(i.a)(k,2),R=N[0],E=N[1];return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"RulesForm-ActionsContainer",children:[Object(O.jsx)(b.a,{shape:"circle",icon:Object(O.jsx)(B.a,{}),size:"Large",onClick:c}),t&&Object(O.jsx)("div",{className:"RulesForm-HorizontalItems",children:Object(O.jsx)(b.a,{type:"primary",danger:!0,size:"Large",children:"Eliminar"})})]}),Object(O.jsx)(C.a,{}),Object(O.jsx)(w,{data:!!a&&{name:a.name,formula:a.formula},disabled:F}),Object(O.jsx)(C.a,{}),Object(O.jsx)(g.a,{placeholder:"Selecciona un filtro",style:{width:200,marginBottom:d>=0&&24},value:d>=0?d:null,onChange:function(e){h(e)},children:s.map((function(e,t){return Object(O.jsx)(z,{value:t,children:"p".concat(t)},t)}))}),d>=0&&s[d](x,(function(){return function(e){delete s[e];var t=s.filter((function(e){return!!e}));h(t.length>0?0:-1),x&&o(t)}(d)}),F),Object(O.jsx)(C.a,{}),Object(O.jsxs)("div",{className:"RulesForm-ActionsContainer",children:[Object(O.jsxs)("div",{className:"RulesForm-HorizontalItems",children:[Object(O.jsx)(b.a,{danger:!x,type:x&&"primary",onClick:function(){v(!x),E(!R)},disabled:F,children:x?"Listo":"Quitar Filtro"}),Object(O.jsx)(b.a,{style:{display:x&&"none"},onClick:function(){o([].concat(Object(p.a)(s),[function(e,t,a){return Object(O.jsx)(L,{showActions:e,onDelete:t,disabled:a})}])),h(s.length)},disabled:F,children:"Nuevo Filtro"})]}),Object(O.jsx)(b.a,{type:"primary",onClick:function(){return I(!F)},disabled:R,children:F?"Editar":"Guardar"})]})]})}function G(e){Object.assign({},e);var t=Object(n.useState)([]),a=Object(i.a)(t,2),c=a[0],l=a[1],r=Object(n.useState)(!1),s=Object(i.a)(r,2),o=s[0],j=s[1],u=Object(n.useState)(-1),d=Object(i.a)(u,2),h=d[0],m=d[1];Object(n.useEffect)((function(){fetch("http://localhost:8000/rules/",{method:"GET"}).then((function(e){return e.json()})).then((function(e){return l(e.rules)})).catch((function(e){return console.log(e)}))}),[]);return o?Object(O.jsx)(T,{actions:!0,data:c[h],onClick:function(){return j(!1)}}):Object(O.jsx)(f.b,{itemLayout:"horizontal",dataSource:c,renderItem:function(e,t){return Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(f.b.Item,{actions:[Object(O.jsx)(b.a,{onClick:function(){return e=t,j(!0),void m(e);var e},type:"text",children:"Ver"})],children:Object(O.jsx)(x.a.Text,{children:e.name})})})}})}var P=o.a.Header,V=o.a.Content;o.a.Footer;function H(e){Object.assign({},e);var t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],l=a[1],r=Object(n.useState)(null),s=Object(i.a)(r,2),b=s[0],d=s[1];Object(n.useEffect)((function(){d(c?Object(O.jsx)(T,{onClick:h}):Object(O.jsx)(G,{}))}),[c,d]);var h=function(){return l(!1)};return Object(O.jsxs)(o.a,{children:[Object(O.jsx)(P,{style:{position:"fixed",width:"100%",zIndex:2},children:Object(O.jsx)(m,{onClick:function(){return l(!0)}})}),Object(O.jsx)(V,{style:{minHeight:"100vh",paddingTop:88,background:"#fff"},children:Object(O.jsx)(j.a,{justify:"center",children:Object(O.jsx)(u.a,{xl:20,xxl:16,xs:22,children:b})})})]})}var q=a(461),J=a(468),M=a(90),Q=a(471),U=a(472),_=a(473),K=(a(453),function(e,t,a){return"boolean"===typeof e&&e?Object(O.jsx)(M.a,{style:{fontSize:16}}):"boolean"!==typeof e||e?a?Object(O.jsx)(Q.a,{onClick:t,style:{fontSize:18}}):Object(O.jsx)(U.a,{onClick:t,style:{fontSize:18}}):Object(O.jsx)(I.a,{style:{fontSize:16}})});function X(e,t){return e}function Y(e){Object.assign({},e);var t=Object(n.useState)(null),a=Object(i.a)(t,2),c=a[0],l=a[1],r=Object(n.useState)(!1),s=Object(i.a)(r,2),o=s[0],j=s[1],u=Object(n.useState)(null),d=Object(i.a)(u,2),h=d[0],m=d[1],f=Object(n.useState)(!1),x=Object(i.a)(f,2),v=x[0],g=x[1],y=Object(n.useState)([]),S=Object(i.a)(y,2),F=S[0],C=S[1];return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(q.a,{name:"file",accept:".ifc",maxCount:1,action:"http://localhost:8000/upload",onChange:function(e){"done"===e.file.status?(l(e.file.response.uuid),j(!0)):e.file.status},onRemove:function(){j(!1),l(null)},children:Object(O.jsx)(b.a,{icon:Object(O.jsx)(_.a,{}),children:"Subir archivo"})}),o&&Object(O.jsx)(b.a,{style:{marginTop:24,marginBottom:24},type:"primary",onClick:function(){m(null),g(!0),fetch("http://localhost:8000/parse/".concat(c),{method:"POST"}).then((function(e){return g(!1),e.json()})).then((function(e){m(e.data),C(e.data.map((function(e){return!1})))})).catch((function(e){return console.log(e)}))},loading:v,disabled:v,children:v?"Validando":"Validar"}),h&&Object(O.jsx)(J.a,{children:Object.keys(h).map((function(e,t){return Object(O.jsx)(J.a.Item,{className:"FileUploader-Fade",style:{animationDelay:"".concat(200*t,"ms")},dot:K(h[e],(function(){return function(e){F[e]=!F[e],C(Object(p.a)(F))}(t)}),F[t]),color:(a=h[e],"boolean"===typeof a&&a?"green":"boolean"!==typeof a||a?"blue":"red"),children:F?X(e,h[e]):X(e)},t);var a}))})]})}var Z=o.a.Header,$=o.a.Content;o.a.Footer;function W(e){Object.assign({},e);return Object(O.jsxs)(o.a,{children:[Object(O.jsx)(Z,{style:{position:"fixed",width:"100%",zIndex:2},children:Object(O.jsx)(m,{})}),Object(O.jsx)($,{style:{minHeight:"100vh",paddingTop:88,background:"#fff"},children:Object(O.jsx)(j.a,{justify:"center",children:Object(O.jsx)(u.a,{xl:20,xxl:16,xs:22,children:Object(O.jsx)(Y,{})})})})]})}a(454);l.a.render(Object(O.jsx)(r.a,{children:Object(O.jsxs)(s.c,{children:[Object(O.jsx)(s.a,{path:"/upload",children:Object(O.jsx)(W,{})}),Object(O.jsx)(s.a,{path:"/",children:Object(O.jsx)(H,{})})]})}),document.getElementById("root"))}},[[455,1,2]]]);
//# sourceMappingURL=main.349fe5b0.chunk.js.map